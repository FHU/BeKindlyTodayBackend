generator client {
    provider = "prisma-client-js"
}

datasource db {
    provider = "postgresql"
    url      = env("DATABASE_URL")
}

model User {
    id          Int          @id @unique @default(autoincrement())
    email       String       @unique
    username    String
    password    String
    completions Completion[]
}

model Challenge {
    id          Int          @id @unique @default(autoincrement())
    prompt      String
    suggestion  String
    date        DateTime     @unique
    source      String
    completions Completion[]

    @@index([date])
}

model Completion {
    id           Int       @id @unique @default(autoincrement())
    description  String
    date         DateTime  @default(now())
    user_id      Int
    challenge_id Int
    user         User      @relation(fields: [user_id], references: [id], onDelete: Cascade)
    challenge    Challenge @relation(fields: [challenge_id], references: [id], onDelete: Cascade)

    @@unique([user_id, challenge_id], name: "user_id_challenge_id")
    @@index([date])
}
